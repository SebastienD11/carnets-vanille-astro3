---
import Layout from '../layouts/Layout.astro'
import Archive from '../templates/Archive.astro'
import Single from '../templates/Single.astro'
import { getNodeByURI } from '../api/uri'
import { getAllUris } from '../api/getUris'

export async function getStaticPaths() {
  return await getAllUris('fr')
}

const uri = `/${Astro.params.uri}/`
const data = await getNodeByURI(uri)
const node = data.nodeByUri

function resolveContentTemplate(type: string) {
  let template
  switch (type) {
    case 'Post':
      template = Single
      break
    case 'Page':
      template = Single
      break
    case 'Category':
      template = Archive
      break
    case 'Tag':
      template = Archive
      break
    default:
      template = Single
  }

  return template
}

const Template = resolveContentTemplate(node.__typename)
---

<Layout title={node.title || node.name}>
  <Template node={node} />
</Layout>
