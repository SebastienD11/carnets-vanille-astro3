---
import FormattedDate from '../../components/formatedDate.astro'
import { Image } from 'astro:assets'
import { getRelativeLocaleUrl } from 'astro:i18n'
import type { Post } from '../../api/post'
import { useTranslations } from '../../i18n/ui'
import { decode } from 'html-entities'

type Props = {
  post: Post
  isRelatedPost?: boolean
}

const lang = Astro.currentLocale as string
const t = useTranslations(lang)
const { post, isRelatedPost }: Props = Astro.props
---

<article>
  <a
    class="dark:border-zink-800 dark:bg-zink-800 group block overflow-hidden rounded-lg border bg-white no-underline transition hover:-translate-y-1 hover:no-underline hover:shadow-lg"
    href={getRelativeLocaleUrl(lang, `/${post.slug}`)}
    aria-label={post.title}
  >
    {
      post.featured_media_data[0] && (
        <Image
          src={post.featured_media_data[0]}
          alt={
            post.featured_media_data['alt_text']
              ? post.featured_media_data['alt_text']
              : post.title.rendered
          }
          width={post.featured_media_data[1]}
          widths={[330, 480, 730]}
          loading={isRelatedPost ? 'lazy' : 'eager'}
          sizes={`(max-width: 360px) 330px, (max-width: 480px) 480px, (max-width: 480px) 480px, (max-width: 767px) 730px, (max-width: 1279px) 330px, 480px`}
          height={post.featured_media_data[2]}
          class="my-0 h-auto w-full transition-shadow duration-300 group-hover:shadow-lg"
        />
      )
    }
    <div class="flex flex-col gap-2 p-6">
      <p class="text-zink-700 dark:text-zink-300 text-sm italic">
        {t('card.date.modified')}
        <FormattedDate date={post.modified} />
      </p>
      <h3 class="text-lg font-bold md:text-xl">{decode(post.title.rendered)}</h3>
      {
        post.excerpt.rendered && (
          <div class="prose-zink prose dark:prose-invert" set:html={post.excerpt.rendered} />
        )
      }
    </div>
  </a>
</article>
