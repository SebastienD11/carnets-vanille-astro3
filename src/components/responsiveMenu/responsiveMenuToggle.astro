---
import ToggleThemeIcon from '../../components/theme/Icon.astro'
---

<div
  id="responsive-menu-toggle"
  class="fixed right-4 top-4 z-10 flex -translate-y-full flex-col items-center gap-4 rounded-full bg-vanille bg-vanille/80 px-1 py-2 text-stone-900 opacity-50 shadow-md backdrop-blur transition duration-300 md:hidden"
>
  <button type="button" toggle-drawer class="flex appearance-none flex-col items-center font-bold">
    <span>M</span>
    <span>E</span>
    <span>N</span>
    <span>U</span>
  </button>
  <button
    type="button"
    toggle-search-drawer
    class="flex appearance-none items-center justify-center"
    aria-label="Search"
  >
    <i class="icon-search text-xl"></i>
  </button>
  <ToggleThemeIcon color="text-dark" />
</div>
<script is:inline>
  (function () {
    let responsiveMenuToggle = document.getElementById('responsive-menu-toggle')
    let lastScrollY = window.scrollY

    // Function to show the toggle (fully visible)
    function showToggle() {
      responsiveMenuToggle.classList.add('opacity-100', 'translate-y-0')
      responsiveMenuToggle.classList.remove('opacity-50', '-translate-y-full')
    }

    // Function to hide the toggle (default state - slightly visible)
    function hideToggle() {
      responsiveMenuToggle.classList.remove('opacity-100', 'translate-y-0')
      responsiveMenuToggle.classList.add('opacity-50', '-translate-y-full')
    }

    // Handle tap/click on the toggle container - show it fully when tapped
    responsiveMenuToggle.addEventListener('click', function () {
      showToggle()
    })

    // Handle scroll direction
    window.addEventListener('scroll', function () {
      const currentScrollY = window.scrollY
      const scrollDifference = currentScrollY - lastScrollY

      // Reset to default state when at the top
      if (currentScrollY <= 10) {
        hideToggle()
        lastScrollY = currentScrollY
        return
      }

      // Scroll down: show toggle
      if (scrollDifference > 0) {
        showToggle()
      }
      // Scroll up: hide toggle (back to default state)
      else if (scrollDifference < 0) {
        hideToggle()
      }

      lastScrollY = currentScrollY
    })
  })()
</script>
